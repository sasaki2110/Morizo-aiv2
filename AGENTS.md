1. まず、serena を有効活用できるように、有効化して下さい。

2. そして、決して先走って、ソースの修正作業をしないで下さい。
かならず、作業プランを提示して、私の承認を得てから、修正作業に着手して下さい。
プランを提示する際は、
- 修正する場所（ファイル名と関数名もしくは行番号）
- 修正する内容
- 修正の理由
- 修正の影響
をかならず明示して下さい。

3. そして、先走らないとは、必ず承認を得る事です。
私が明確に「承認します」と入力しない場合は、
絶対にソースを修正しないで下さい。

私が「承認」と入力した場合でも、作業してはいけません。
「承認しない」の誤入力かもしれません。

serena メモリの AIの不適切な行動と改善点 も読んで下さい。

あなた（コーデイング支援AI）は**必ず間違える（必要な処理を消す。勝手に存在しないメソッドを呼ぶ等** のですから、
**ソース修正は、絶対に承認後**を遵守してください。かたく**破壊的行動は謹んでください**。

serena メモリの Service層設計とマッピング機能 も読んで下さい。


## 🌐 Phase 5: API層実装へ　に着手。
レシピビューアーまで、フロント-バック連携での疎通確認完了！

---
バック残件
- 4タスクあるときの、進捗をSSEへ送信  （当然2タスクでも） ⇒ 完了
- レシピ提案時の、チャット文字列の最適化 ⇒ 完了

バックは完成したかも！！！

### バック残課題
---
#### 1 ダイエット 完了

---
#### 2 RAG
主菜・副菜・汁物の分類が微妙。

主菜は\"レシピ分類\":\"主菜\"
副菜は\"レシピ分類\":\"副菜\"
汁物は\"カテゴリ\":\"汁もの
を選びたい。

最終的な方法論は、３つのベクトルＤＢを作る事。
- 主菜・副菜・汁物それぞれ専用のベクトルＤＢを作る
- 主菜・副菜は、元データのレシピ分類で、主菜だけ、副菜だけのベクトルＤＢを作る。
- 汁物は、"カテゴリ":"汁ものスープ"　のような、カテゴリに「汁もの」が含まれるデータでベクトルＤＢを作る。
- その為には、ベクトルＤＢ生成スクリプトを作り直す必要がある。

検索時には。
- RAG検索時に、上記を主菜・副菜・汁物別に３回検索する。（絶対重複しない。はず）
- また、recipe_rag/search.py を３回検索に拡張が必要。

将来的に
- レシピ分類:その他で、ベクトルＤＢを作れば、ワンディッシュ系（昼食用）にも対応可能。

---
#### 3 在庫一覧

同一アイテム、複数レコードの合算表示
出来れば、肉⇒野菜⇒その他のソート

---
#### 4 献立制約

和食って縛りが入ってる？

---
#### 4 コンテキスト強化

1. ユーザー：牛乳を削除して　（曖昧）
2. AI:どれ消すか選んで？
3. ユーザー：最新のでお願い

が実装できるように。

一応タスクチェーンとか実装（中身はないかもしれないけど）
されてたはずだけど。

---

そして、**TODOが残っていないか確認。**
⇒一杯残ってる。。。

曖昧性やら。。。
必要に応じて実装することにして、
一旦、フェーズ４は完了。

