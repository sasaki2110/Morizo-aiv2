あなた（コーデイング支援AI）は**必ず間違える** のですから、**ソース修正は、絶対に承認後**を遵守してください。
かたく**破壊的行動は謹んでください**。

## 🌐 Phase 5: API層実装へ　に着手。

現在、一旦 API の実装まで完了。
フロントから「こんにちは」すら疎通せず、難航中。 ⇒ 認証を正しく実装し。対応完了。

今見えている課題。
1. こんにちは　の簡単なリクエストで、複雑なタスクプランナーを動かす是非
　⇒ いったん、このまま進めよう
2. こんにちは　のレスポンスが　「処理が完了しました。」 
　⇒ フロント側の要求に合わせて、完了
3. 2. の後、しばらくフロントを放置していると、フロントで エラー: The operation timed out. になる。
　⇒ ハートビートで完了
4. 今の在庫を教えてで、ERROR - ❌ [MCP] Tool inventory_list failed: Authentication failed が発生。
　⇒ トークン伝播で完了
5. 新たに、「今の在庫を教えて」が表示されたままになる。
 ⇒ format_final_response を task 依存から、処理名依存へ変更で完了
6. 新たに、「在庫から作れる献立とレシピを教えて」でフォーマットエラー
 ⇒ llm_menu と rag_menu の型を正確に抽出して完了

---
後は、フロント表示とレスポンスの、細かい詰めか。。。
従来は、最終回答をLLMが生成していたので、割とマークダウン形式だった
今は、フォーマッターが最終回答を整形しているので、ただの文字列　⇒　フロントの表示が汚い
---

そして、**TODOが残っていないか確認。**
⇒一杯残ってる。。。

曖昧性やら。。。
必要に応じて実装することにして、
一旦、フェーズ４は完了。

